<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/home.css" />
    <style>
      body {
        background: #f8fafc;
        color: #0f172a;
        font-family: "Helvetica Neue", Arial, sans-serif;
      }
      .fileView {
        display: flex;
        flex-direction: column;
        gap: 20px;
        min-height: 100vh;
        padding: 32px;
      }
      .fileHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e2e8f0;
        padding-bottom: 16px;
      }
      .fileTitle {
        font-size: 2rem;
        font-weight: 700;
      }
      .fileActions {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .editForm {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      .editForm input {
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid #cbd5e1;
        min-width: 240px;
      }
      .viewer {
        flex: 1;
        min-height: 60vh;
        background: #ffffff;
        border: 1px solid #e2e8f0;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(15, 23, 42, 0.08);
        overflow: hidden;
      }
      .fileFrame {
        width: 100%;
        height: 100%;
        border: none;
      }
      .fallback {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: #475569;
      }
    </style>
  </head>
  <body>
    <div class="fileView">
      <div class="fileHeader">
        <div class="fileTitle"><%= file.name %></div>
        <div class="fileActions">
          <button type="button" onclick="toggleEdit()">edit</button>
          <form action="/softDeleteFile" method="POST">
            <input hidden name="deleteThisFile" value="<%= file.id %>" />
            <button type="submit">delete</button>
          </form>
        </div>
      </div>

      <form class="editForm hidden" action="/updateFileName" method="POST">
        <label for="newFileName">name</label>
        <input
          id="newFileName"
          name="newFileName"
          value="<%= file.name %>"
          aria-label="Rename file"
        />
        <input hidden name="fileID" value="<%= file.id %>" />
        <input hidden name="folderID" value="<%= file.folderId %>" />
        <div class="fileActions">
          <button type="button" onclick="toggleEdit()">cancel</button>
          <button type="submit">save</button>
        </div>
      </form>

      <div class="viewer">
        <object data="<%= fileUrl %>" class="fileFrame">
          <div class="fallback">
            <div>Preview not available.</div>
            <a href="<%= fileUrl %>" download>Download file</a>
          </div>
        </object>
      </div>
    </div>

    <script>
      function toggleEdit() {
        const form = document.querySelector(".editForm");
        form.classList.toggle("hidden");
      }
    </script>
  </body>
</html>
